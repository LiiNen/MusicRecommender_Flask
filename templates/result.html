<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='result.css')}}">
        <title>MR</title>
    </head>
    <body>
        <h1 id='main'>Music Recommender</h1>
        <div></div>
        <div id="music_wrapper">
            <div class='select_title'>선택한 노래의 하이라이트</div>
            <div id="music_name">{{search_type}}</div>
            <audio controls src="{{url_for('static', filename='music_dataset/')}}" id="music_player" style="display: none"></audio>
        </div>
        <div id = 'result_box'>
            <div class='header'>추천하는 노래 및<br>하이라이트 미리듣기</div>
            <div id = 'listen_component_box' class='component_box'>
                <div class='header'>듣기 좋은 노래</div>
            </div>
            <div id = 'sing_component_box' class='component_box'>
                <div class='header'>부르기 좋은 노래</div>
            </div>
        </div>

        <script src="{{url_for('static', filename='result.js')}}"></script>
        <script type="text/javascript">
            if ("{{search_type}}" == 'upload') {
                console.log('upload')
                music_player = document.getElementById('music_player')
                music_player.src = "{{url_for('static', filename='output.wav')}}"
            }
            else {
                searchWithTitle("{{search_type}}")
                if(document.getElementById('music_name').innerHTML == "") {
                    document.getElementById('music_name').innerHTML = "잘못된 접근입니다.";
                }
                else {
                    document.getElementById('music_player').style.display = 'inline-block';
                }
            }

            predict_list = "{{predict_result_list}}"
            predict_list = predict_list.replaceAll('&#39;', '').replaceAll('&#34;', '')
            predict_list = predict_list.substring(0, predict_list.length-1).split(',')
            predict_list_length = predict_list.length
            for(var i = 0; i < predict_list_length; i++) {
                predict_list[i] = predict_list[i].substring(1)
            }
            // console.log(predict_list) // 음악 리스트
            if(predict_list_length == 1 && predict_list[0] == "") console.log('nothing')
            else {
                if (predict_list_length > 10) predict_list_length = 10
                makeResult("{{search_type}}")
            }
        </script>

        {%with messages = get_flashed_messages()%}
        {%if messages %}
        <script type="text/javascript">
            alert("{{messages[-1]}}");
        </script>
        {%endif%}
        {%endwith%}
    </body>
</html>